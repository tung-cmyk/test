import{_ as E,r as g,o as x,s as y,c as B,a as t,b as S,d as o,w as z,e as D,t as r,n as w,F as m,f as h,g as s,h as k}from"./index-BwID5z7X.js";const F={class:"wrapper"},K={key:0},L={key:1},O={key:2},V={class:"filter-bar"},j=["onClick"],A={class:"categories"},I={class:"category-title"},M={key:0},T={key:1,class:"news-list"},$={class:"meta"},J={__name:"Categories",setup(N){const b=g(!0),p=g(null),v=g({}),l=g(null);x(async()=>{try{const{data:_,error:e}=await y.from("news").select(`
        id,
        title,
        content,
        author,
        published_at,
        tags,
        game_id,
        games ( name )
      `).order("published_at",{ascending:!1});if(e)throw e;const{data:f,error:a}=await y.from("tags").select("id, name");if(a)throw a;const u=Object.fromEntries(f.map(i=>[i.id,i.name])),n={};_.forEach(i=>{let d=i.tags;if(typeof d=="string")try{d=JSON.parse(d)}catch{d=[]}d.map(c=>u[c]).filter(Boolean).forEach(c=>{n[c]||(n[c]=[]),n[c].push({...i,game_name:i.games?.name||"Unbekanntes Spiel"})})}),v.value=n}catch(_){console.error(_),p.value="Fehler beim Laden der Kategorien."}finally{b.value=!1}});const C=B(()=>l.value?{[l.value]:v.value[l.value]||[]}:v.value);return(_,e)=>{const f=D("router-link");return s(),t("div",F,[S(f,{to:"/",class:"back-link"},{default:z(()=>[...e[1]||(e[1]=[k("⬅️ go back",-1)])]),_:1}),e[4]||(e[4]=o("h2",null,"Categories",-1)),b.value?(s(),t("div",K,"Lade Kategorien...")):p.value?(s(),t("div",L,r(p.value),1)):(s(),t("div",O,[o("div",V,[o("button",{class:w(["filter-btn",{active:l.value===null}]),onClick:e[0]||(e[0]=a=>l.value=null)}," Alle ",2),(s(!0),t(m,null,h(Object.keys(v.value),a=>(s(),t("button",{key:a,class:w(["filter-btn",{active:l.value===a}]),onClick:u=>l.value=a},r(a),11,j))),128))]),o("div",A,[(s(!0),t(m,null,h(C.value,(a,u)=>(s(),t("div",{key:u,class:"category-block"},[o("h3",I,r(u),1),a.length===0?(s(),t("div",M,[...e[2]||(e[2]=[o("p",null,"Keine Artikel vorhanden.",-1)])])):(s(),t("div",T,[(s(!0),t(m,null,h(a,n=>(s(),t("div",{key:n.id,class:"news-card"},[o("h4",null,r(n.title),1),o("p",$,[e[3]||(e[3]=k(" Spiel: ",-1)),o("strong",null,r(n.game_name),1),k(" · von "+r(n.author)+" · "+r(n.published_at),1)]),o("p",null,r(n.content),1)]))),128))]))]))),128))])]))])}}},G=E(J,[["__scopeId","data-v-efb06096"]]);export{G as default};
